
<section class="reserva-container">
  <h2 class="reserva-title">Hac√© tu reserva</h2>

  <form class="reserva-form" [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Restaurante -->
    <div class="form-group">
      <label for="restaurante">Restaurante</label>
      <select id="restaurante" formControlName="restaurante">
        <option value="">Seleccion√° un restaurante</option>

        <option *ngFor="let r of restaurantes" [value]="r.nroRestaurante">
          {{ r.razonSocial }}
        </option>
      </select>
    </div>

    <!-- Sucursal -->
    <div class="form-group">
      <label for="sucursal">Sucursal</label>
      <select id="sucursal" formControlName="sucursal">
        <option value="">Seleccion√° una sucursal</option>

        <option *ngFor="let s of sucursales" [value]="s.nroSucursal">
          {{ s.nomSucursal }}
        </option>
      </select>
    </div>

    <!-- Fecha -->
    <div class="form-group">
      <label for="fecha">Fecha</label>
      <input id="fecha" type="date" formControlName="fecha" />
    </div>

    <!-- Cantidad de personas -->
    <div class="form-group">
      <label for="personas">Cantidad de personas</label>
      <select id="personas" formControlName="personas">
        <option value="">Seleccion√° cantidad</option>
        <option *ngFor="let c of cantidadesComensalesOpciones" [value]="c">
          {{ c }}
        </option>
      </select>
    </div>

    <!-- cantidad de menores -->
    <div class="form-group">
      <label for="menores">Cantidad de menores</label>
      <select id="menores" formControlName="menores">
        <option value="">Seleccion√° cantidad</option>
        <option *ngFor="let c of cantidadesComensalesOpciones" [value]="c">
          {{ c }}
        </option>
      </select>
    </div>

    <!-- Turno / Hora -->
    <!-- Turnos como cuadraditos -->
<div class="form-group">
  <label>Turno</label>

  <ng-container *ngIf="turnosDisponibles.length > 0; else emptyTurnos">
    <div class="turnos-container">
      <button
        type="button"
        *ngFor="let t of turnosDisponibles"
        class="turno-card"
        [class.selected]="form.get('turno')?.value === t.horaReserva"
        [class.disabled]="isTurnoDisabled(t)"
        [disabled]="isTurnoDisabled(t)"
        (click)="form.get('turno')?.setValue(t.horaReserva)"
      >
        <div class="hora">
          {{ t.horaReserva.slice(0, 5) }} - {{ t.horaHasta.slice(0, 5) }}
        </div>
        <div class="cupo">
          Disponibles: {{ t.cupoDisponible }}
        </div>
      </button>
    </div>
  </ng-container>

  <ng-template #emptyTurnos>
    <div class="turnos-placeholder">
      Seleccion√° restaurante, sucursal y fecha para ver los turnos disponibles
    </div>
  </ng-template>
</div>



    <button type="submit" [disabled]="form.invalid">Reservar</button>
  </form>
</section>


<!-- MODAL CONFIRMACION -->
<div class="modal-backdrop" *ngIf="mostrarModal">
  <div class="modal-box">
    <h3>üéâ Reserva confirmada</h3>

    <p>
      Has realizado tu reserva para 
      <strong>{{ modalData.restaurante }}</strong>
    </p>

    <p>
      <strong>Sucursal:</strong> {{ modalData.sucursal }}
    </p>

    <p>
      <strong>Fecha:</strong> {{ modalData.fecha | date:'dd/MM/yyyy' }}
    </p>

    <p>
      <strong>Hora:</strong> {{ modalData.hora }}hs
    </p>

    <p>
      Tu c√≥digo de reserva es:
      <strong class="codigo">{{ modalData.codigo }}</strong>
    </p>

    <button (click)="irHome()">Aceptar</button>
  </div>
</div>

<!-- MODAL ERROR -->
<div class="modal-backdrop" *ngIf="mostrarModalError">
  <div class="modal-box modal-error">
    <h3>‚ö†Ô∏è Hubo un error al realizar la reserva</h3>

    <button (click)="cerrarModalError()">Aceptar</button>
  </div>
</div>
