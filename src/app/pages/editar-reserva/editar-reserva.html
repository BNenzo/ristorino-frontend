<app-banner></app-banner>

<section class="reserva-container">
  <h2 class="reserva-title">Hacé tu reserva</h2>

  <form class="reserva-form" [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Restaurante -->
    <div class="form-group">
      <label for="restaurante">Restaurante</label>
      <input id="restaurante" type="text" [value]="reserva.razonSocial" disabled />
    </div>

    <!-- Sucursal -->
    <div class="form-group">
      <label for="sucursal">Sucursal</label>

      <input id="sucursal" type="text" [value]="reserva.nomSucursal" disabled />
    </div>

    <!-- Fecha -->
    <div class="form-group">
      <label for="fecha">Fecha</label>
      <input id="fecha" type="date" formControlName="fecha" />
    </div>

    <!-- Cantidad de personas -->
    <div class="form-group">
      <label for="personas">Cantidad de personas</label>
      <select id="personas" formControlName="personas">
        <option value="">Seleccioná cantidad</option>
        <option *ngFor="let c of cantidadesComensalesOpciones" [ngValue]="c">
          {{ c }}
        </option>
      </select>
    </div>

    <!-- cantidad de menores -->
    <div class="form-group">
      <label for="menores">Cantidad de menores</label>
      <select id="menores" formControlName="menores">
        <option value="">Seleccioná cantidad</option>
        <option *ngFor="let c of cantidadesComensalesOpciones" [value]="c">
          {{ c }}
        </option>
      </select>
    </div>

    <!-- Turno / Hora -->
    <div class="form-group">
      <label>Turno</label>

      <ng-container *ngIf="turnosDisponibles.length > 0; else emptyTurnos">
        <div class="turnos-container">
          <button
            type="button"
            *ngFor="let t of turnosDisponibles"
            class="turno-card"
            [class.selected]="form.get('turno')?.value === t.horaReserva"
            [class.disabled]="isTurnoDisabled(t)"
            [disabled]="isTurnoDisabled(t)"
            (click)="form.get('turno')?.setValue(t.horaReserva)"
          >
            <div class="hora">{{ t.horaReserva.slice(0, 5) }} - {{ t.horaHasta.slice(0, 5) }}</div>
            <div class="cupo">Disponibles: {{ t.cupoDisponible }}</div>
          </button>
        </div>
      </ng-container>

      <ng-template #emptyTurnos>
        <div class="turnos-placeholder">
          Seleccioná restaurante, sucursal y fecha para ver los turnos disponibles
        </div>
      </ng-template>
    </div>

    <button type="submit" [disabled]="form.invalid" class="button-base button-submit">
      Reservar
    </button>
    <button type="button" (click)="confirmarReserva()" class="button-base button-confirmar">
      Confirmar
    </button>
  </form>
</section>
